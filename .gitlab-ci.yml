include:
  - remote: 'https://gitlab.com/cscs-ci/recipes/-/raw/master/templates/v2/.ci-ext-devel.yml'

stages:
  - run

  #test:
  #  extends: .container-runner-todi-gh200
  #  tags: [f7t-runner-tds]
  #  stage: run
  #  image: docker.io/ubuntu:24.04
  #  script:
  #    - cat /etc/os-release

  #test:
  #  extends: .baremetal-runner-eiger-zen2
  #  tags: [f7t-runner-tds]
  #  timeout: 2m
  #  stage: run
  #  script:
  #    - sleep 1000
  #  variables:
  #    CSCS_GLR_F7T_URL_PREFIX: /citest/glr_f7t
  #    SLURM_TIMELIMIT: '00:20:00'
  #    SLURM_JOB_NUM_NODES: 100

test:
  extends: .container-runner-lightweight-zen2
  image: ghcr.io/ankitpokhrel/jira-cli:latest
  stage: test
  script:
    - |
      jira init
      --installation local
      --server 'https://jira.cscs.ch'
      --login anfink
      --project VCUE
      --board None
    - |
      jira issue create
      --no-input
      -t Task
      -p VCUE
      -s "anfink: Test Jira Ticket from Pipeline"
      -b "Body for ticket"
  variables:
    JIRA_AUTH_TYPE: bearer
    JIRA_API_TOKEN: $JIRA_TOKEN

    #test:
    #  extends: .uenv-builder-todi-gh200
    #  stage: run
    #  variables:
    #    UENV_RECIPE: uenv-recipes/prgenv-gnu/24.11/gh200
    #    UENV_NAME: linalg
    #    UENV_VERSION: 24.11
    #    SPACK_DEVELOP: '-d'

  #test uenv run:
  #  extends: .uenv-runner-eiger-zen2
  #  needs: ['test']
  #  stage: run
  #  image: 'prgenv-gnu/24.7:$CI_PIPELINE_ID'
  #  script:
  #    - uenv view develop
  #    - mpic++ --version
